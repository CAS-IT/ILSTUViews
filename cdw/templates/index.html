{% extends "/layouts/public.html" %}

{% block content %} 
<div class="shim">     
  <div class="debates-gallery">
    <div class="gallery-container">
      <ul class="debates"></ul>
      <div class="detail"></div>
      <div class="question">
        <hr class="top"/>
          <span class="question-text"></span>
        <hr class="bottom"/>
      </div>
      <a class="browse-all" href='#'>Browse all responses</a>
    </div>
    
  </div>
  <div class="stats-outer"></div>
  <div class="responses-outer"></div>
  <div class="join-outer"></div>
</div>
{% endblock %}

{% block page_scripts %}
  <script>
    var questionId = {% if question_id %}'{{ question_id }}'{% else %}undefined{% endif %};
  </script>
  {% assets "js_home" %}
  <script defer type="text/javascript" src="{{ ASSET_URL }}"></script>{% endassets %}
  
  <!-- Templates --> 
  <script type="text/template" id="gallery-item-template">
    <a href="#/questions/<%= qid %>/debates/<%= id %>" class="hit-area"><img src="{{ media_root }}/images/<%= firstPost.author.id %>.jpg" width="550" height="647"/></a>
  </script> 
  
  <script type="text/template" id="debate-detail-template">
    <div class="stats">
      <a href="#" class="stats-btn"><img src="/static/images/stats_button.png"/></a>
    </div>
    <div class="body <%= yesNoClass %>">
      <div class="headline"><%= firstPost.author.username %> Says: <%= firstPost.yesNo ? 'Yes' : 'No' %>!</div>
      <div class="rag"><%= raggedText %></div>
    </div>
    <div class="menu <%= yesNoClass %>">
      {% if current_user.is_authenticated() %}
      <a class="like btn" href="#"><strong><%= firstPost.likes %></strong><img src="/static/images/like_icon.png"/><span class="divider">&nbsp;</span>Like</a>
      {% else %}
      <a class="like btn" href=""><strong><%= firstPost.likes %></strong><img src="/static/images/like_icon.png"/></a>
      {% endif %}
      <a class="responses btn" href="#/questions/<%= question.id %>/debates/<%= id %>/posts"><span class="response-amt"></span> Responses</a>
      <a class="flag btn" href="#"><img src="/static/images/flag_icon.png"/></a>
    </div>
    <div class="join"><a href="#" class="{% if current_user.is_authenticated() %}join-debate-btn{% else %}join-prevent{% endif %}"><img src="/static/images/join_debate_button.png"/></a></div>
  </script>
  
  <script type="text/template" id="responses-template">
    <div class="top-bar">
      <a href="#/questions/<%= qid %>/debates/<%= did %>"><img class="close-btn" src="/static/images/close_x_btn_black.png"/></a>
    </div>
    <div class="responses-list"></div>
  </script>
  
  <script type="text/template" id="responses-item-template">
    <div class="span-4">
      <img src="" width="77" height="110"/>
    </div>
    <div class="span-18">
      <h4><%= author.username %> says:</h4>
      <div class="rag"><%= raggedText %></div>
    </div>
    <% if(author.id != '{{ current_user.id }}') { %>
    <a href="#" class="debate-this {% if current_user.is_authenticated() %}reply-btn{% else %}signin-btn{% endif %}">Debate This!</a>
    <% } %>
  </script>
  
  <script type="text/template" id="join-debate-template">
  	<div class="question-header">
  	  <h3>Adding an Opinion</h3>
  		<h4><%= question %></h4>
  		<a href="#" class="close-btn"><img src="/static/images/close_x_btn.png"/></a>
  	</div>
  	<div class="step step-1">
  	  <p>&nbsp;</p>
  		<p><button class="next add">Add a new opinion</button> OR <button class="next reply"><img src="/static/images/users/<%= firstPost.author.id %>-thumb.jpg" width="40" height="60"/> Debate <%= firstPost.author.username %>...</button></p>
  	</div>
  	<div class="step step-2">
  		<p>Your Opinion is: (Please Select One)</p>
  		<p><button class="next yes">Yes!</button> OR <button class="next no">No!</button></p>
  	</div>
  	<div class="step step-3">
  	  <form action="" method="POST">
  	    <input type="hidden" name="author" value="{{ current_user.get_id() }}"/>
        <input type="hidden" name="yesno" value="1"/>
        <input type="hidden" name="origin" value="web"/>
    		<p>You said:</p>
    		<p><span class="yes">Yes!</span><span class="no">No!</span></p>
    		<p>What would you say to convince others of your opinion?</p>
    		<div class="chars-left">
    		  <textarea name="text"></textarea>
    		  <p><span></span> Characters Left</p>
    		</div>
    		<p>Follow this debate via:</p>
        <p><input type="checkbox" name="follow_sms" class="fancy"/> SMS</p>
        <p><input type="checkbox" name="follow_email" class="fancy"/> Email</p>
        <div class="buttons">
      		<button class="prev">Back</button>
      		<button>Next</button>
      	</div>
      </form>
  	</div>
  </script>
  
  
  <script type="text/template" id="reply-template">
    <div class="panel-header">
      <h4>Add a Response</h4>
      <a href="#" class="close-btn"><img src="/static/images/close_x_btn.png"/></a>
    </div>
    <div class="response-to">
      <div class="span-4">
        <img src="" width="77" height="110"/>
      </div>
      <div class="span-19">
        <h4><%= author.username %>'s Statement</h4>
        <div class="rag"><%= raggedText %></div>
      </div>
    </div>
    <div class="reply-form-outer">
      <form action="/api/threads/<%= did %>/posts">
        <input type="hidden" name="author" value="{{ current_user.get_id() }}"/>
        <input type="hidden" name="yesno" value="1"/>
        <input type="hidden" name="origin" value="web"/>
        <div>You said:</div>
        <div class="response-buttons">
          <button class="yes">Yes!</button>
          <button class="no unselected">No!</button>
        </div>
        <div>What would you say to convince others of your opinion?</div>
        <div><textarea class="reply-input" name="text" maxlength="140"></textarea></div>
        <div class="chars-left"><span></span> Characters Left</div>
        <div class="follow span-8">
          <p>Follow this debate via:</p>
          <p><input type="checkbox" name="follow_sms" class="fancy"/> SMS</p>
          <p><input type="checkbox" name="follow_email" class="fancy"/> Email</p>
        </div>
        <button type="submit" class="submit-btn">Submit This Debate</button>
      </form>
    </div>
    <div class="stripe">&nbsp;</div>
  </script>
  
  <script type="text/template" id="browse-menu-template">
    <div class="sort-menu">
      Sort By:
      <ul>
        <li><a href="#" title="recent">Recent</a></li>
        <li><a href="#" title="yes">Yes</a></li>
        <li><a href="#" title="no">No</a></li>
        <li><a href="#" title="responses">Most Debated</a></li>
      </ul> 
      <a href="#" class="close-btn"><img src="/static/images/close_x_btn_black.png"/></a>
    </div>
    <div class="menu-items"></div>
    <div class="more"><img class="spinner" src="/static/images/spinner.gif"/><a href="#" class="more-btn">More</a></div>
  </script>
  
  <script type="text/template" id="browse-menu-item-template">
    <a href="#/questions/<%= qid %>/debates/<%= id %>">
    <img src="/static/images/users/<%= firstPost.author.id %>-thumb.jpg" width="60" height="85"/>
    <p class="username"><%= firstPost.author.username %></p>
    <p class="responses"><%= posts.count %> Responses</p></a>
  </script>
  
  <script type="text/template" id="stats-screen-template">
    <div class="container">
      <div class="stats-header prepend-3 span-40">
        <h3>Statistics</h3>
        <h4><%= question.text %></h4>
        <select class="navigator">
          <option value="screen-1">Number of Opinions</option>
          <option value="screen-2">Most Frequently Used Words</option>
          <option value="screen-3">Most Liked Opinions</option>
          <option value="screen-4">Most Debated Opinions</option>
        </select>
      </div>
      <div class="span-4">
        <a href="#" class="close-btn"><img src="/static/images/close_x_btn.png"/></a>
      </div>
    </div>
    <div class="num-opinions screen screen-1">
      <div class="opinions-bar">
        <div class="bar yes-bar">
          <div class="total-view">
            <p>Yes</p>
            <p><%= debateTotals.yes %></p>
          </div>
          <img src="/static/images/stats_arrow_yes.gif"/>
        </div>
        <div class="bar no-bar">
          <img src="/static/images/stats_arrow_no.gif"/>
          <div class="total-view">
            <p>No</p>
            <p><%= debateTotals.no %></p>
          </div>
        </div>
      </div>
    </div>
    <div class="most-debated screen screen-2 prepend-6 container">
      <div class="detail-view">
        <ul></ul>
      </div>
      <div class="menu-view">
        <ul></ul>
      </div>
    </div>
    <div class="frequent-words screen screen-3">
      <div class="word-menu">
        <div class="word-row-outer dummy-row">&nbsp;</div>
        <div class="word-row-outer">
          <div class="word-row"></div>
        </div>
        <div class="word-row-outer">
          <div class="word-row"></div>
        </div>
        <div class="word-row-outer">
          <div class="word-row"></div>
        </div>
        <div class="word-row-outer">
          <div class="word-row"></div>
        </div>
        <div class="word-row-outer dummy-row">&nbsp;</div>
      </div>
      <div class="word-detail">
        <div class="container">
          <div>
            <a href="#" class="back-btn">Back</a>
          </div>
          <div class="span-18">
            Hello world!!!!
          </div>
          <div class="responses-outer">
            <div class="responses-list"></div>
          </div>
        </div>
      </div>
    </div>
  </script>
  
  <script type="text/template" id="stats-most-debated-detail-template">
    <img src="/static/images/users/<%= firstPost.author.id %>-web.jpg" width="350" height="390"/>
    <div class="body <%= firstPost.yesNo ? 'yes' : 'no' %>">
      <div class="headline"><%= firstPost.author.username %> Says: <%= firstPost.yesNo ? 'Yes' : 'No' %>!</div>
      <div class="rag"><%= raggedText %></div>
    </div>
    <a class="goto-btn" href="/#/questions/<%= qid %>/debates/<%= id %>">Go To Debate</a>
  </script>
  
  <script type="text/template" id="stats-most-debated-menu-template">
    <div class="span-3 rank">
      <%= rank %>.
    </div>
    <div class="span-12">
      <p><%= firstPost.author.username %>: <%= firstPost.created %></p>
      <p><%= commentCount - 1 %> Rebuttals</p>
    </div>
  </script>
{% endblock %}
